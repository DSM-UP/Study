# Chapter 9. 익스프레스로 SNS 서비스 만들기

## 9.1 프로젝트 구조 갖추기

서버 코드를 수정하면 nodemon이 서버를 자동으로 재시작 해줍니다.
nodemon이 실행되는 콘솔에 rs를 입력해서 수동으로 재시작할 수도 있습니다.

키를 하드코딩하면 소스 코드가 유출되었을 때 키도 같이 유출되므로 별도로 관리해야 합니다.
이를 위한 패키지가 dotenv입니다.
비밀키는 .env라는 파일에 모아두고, dotenv가 .env 파일을 읽어 process.env 객체에 넣습니다.

.env 파일에 키=값 형식으로 비밀키를 추가합니다.

서버 시작 시 .env의 비밀키들을 process.env에 넣으므로 이후로 process.env.COOKIE_SECRET처럼 키를 사용할 수 있습니다.

하드코딩된 비밀번호가 유일하게 남아 있는 파일이 있습니다.
시퀄라이즈 설정을 담아둔 config.json입니다.
JSON 파일이라 process.env를 사용할 수 없습니다.

/profile, /join, /까지 페이지 세 개로 구성되어 있습니다.

main.pug에서는 user 변수가 존재할 때 게시글 업로드 폼을 보여줍니다.

profile.pug는 사용자의 팔로워와 팔로잉 중인 목록을 보여줍니다.

join.pug는 회원가입하는 폼을 보여줍니다.

error.pug는 서버에 에러 발생 시 에러 내역을 보여줍니다.

## 9.2 데이터베이스 세팅하기

로그인 기능이 있으므로 사용자 테이블이 필요하고, 게시글을 저장할 게시글 테이블도 필요합니다.
해시태그를 사용하므로 해시태그 테이블도 만들어야 합니다.

이메일, 닉네임, 비밀번호를 저장하고, SNS 로그인을 하엿을 경우에는 provider와 snsId를 저장합니다.
provider가 local이면 로컬 로그인을 한 것이고, kakao면 카카오 로그인을 한 것입니다.

게시글 모델은 게시글 내용과 이미지 경로를 저장합니다.

해시태그 모델은 태그 이름을 저장합니다.

같은 테이블 간 N:M 관계에서는 모델 이름과 컬럼 이름을 따로 정해주어야 합니다.

as 옵션은 시퀄라이즈가 JOIN 작업 시 사용하는 이름입니다.
